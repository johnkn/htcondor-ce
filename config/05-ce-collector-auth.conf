
###############################################################################
#
# HTCondor-CE Central Collector authentication and authorization configuration
#
# DO NOT EDIT THIS FILE!  It will be overwritten upon RPM upgrade.
# If you wish to make changes to the HTCondor-CE configuration, create files
# in /etc/condor-ce/config.d containing your changes.
#
###############################################################################

# Allow site CEs to advertise to the central collector via SSL (SOFTWARE-3939)
if version > 9.0.6
  # 9.0.6 includes AUTH_SSL_REQUIRE_CLIENT_CERTIFICATE (HTCONDOR-236)
  COLLECTOR.SEC_ADVERTISE_SCHEDD_AUTHENTICATION_METHODS = SSL, GSI
  COLLECTOR.SEC_ADVERTISE_MASTER_AUTHENTICATION_METHODS = SSL, GSI
else
  COLLECTOR.SEC_ADVERTISE_SCHEDD_AUTHENTICATION_METHODS = GSI, SSL
  COLLECTOR.SEC_ADVERTISE_MASTER_AUTHENTICATION_METHODS = GSI, SSL
endif

# Allow CEs and XCache hosts not in the grid-mapfile to advertise to the central collector
COLLECTOR.ALLOW_ADVERTISE_SCHEDD = $(COLLECTOR.ALLOW_ADVERTISE_SCHEDD), $(UNMAPPED_USERS), $(USERS)
COLLECTOR.ALLOW_ADVERTISE_STARTD = $(COLLECTOR.ALLOW_ADVERTISE_STARTD), $(UNMAPPED_USERS), $(USERS)
COLLECTOR.ALLOW_ADVERTISE_MASTER = $(COLLECTOR.ALLOW_ADVERTISE_MASTER), $(USERS)

# Allow the CE registry webapp to approve CE token requests.
COLLECTOR.SEC_DAEMON_AUTHENTICATION_METHODS = FS,TOKEN
COLLECTOR.ALLOW_ADMINISTRATOR=condorce_webapp@htcondor.org/localhost condorce_webapp@htcondor.org/$(FULL_HOSTNAME)

# When requesting a token to register a new CE, only allow it to advertise a schedd.
SEC_TOKEN_REQUEST_LIMITS = ADVERTISE_SCHEDD

# Require a certificate from clients authenticating with SSL
AUTH_SSL_REQUIRE_CLIENT_CERTIFICATE = True
